<html>
<head>
  <title>四、Pandas读写Excel(xlrd、xlwt读写Excel)</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307934 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1165"/>
<h1>四、Pandas读写Excel(xlrd、xlwt读写Excel)</h1>

<div>
<span><div><span style="font-size: 16pt; font-family: 楷体;">import <font style="color: rgb(255, 0, 0);">numpy</font> as</span> <span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">np</span></div><div><span style="font-size: 16pt; font-family: 楷体;">import <font style="color: rgb(255, 0, 0);">pandas</font> as</span> <span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">pd</span></div><div><span style="font-size: 16pt; font-family: 楷体;">import sys</span></div><div><span style="font-size: 16pt; font-family: 楷体;">from <font style="color: rgb(255, 0, 0);">pandas</font> import</span> <span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">Series</span><span style="font-size: 16pt; font-family: 楷体;">,</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">DataFrame</span></div><div><span style="font-size: 16pt; font-family: 楷体;">import</span> <span style="font-size: 16pt; font-family: 楷体;"><font style="color: rgb(255, 0, 0);">xlrd</font>, <font color="#FF0000">xlwt</font></span> <span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">引入读写工作表的库</span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">Excel数据</span></div><div><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">生成xls工作薄</span></div><div><span style="font-size: 16pt; font-family: 楷体;">import</span> <span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">xlrd</span><span style="font-size: 16pt; font-family: 楷体;">,</span> <span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">xlwt #引入读写工作表的库</span></div><div><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;">wb = xlwt.<font style="color: rgb(255, 0, 0);">Workbook</font>()#<font style="color: rgb(255, 0, 0);">创建工作簿</font></span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(wb)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">&lt;xlwt.Workbook.Workbook object at 0x0000000002955E10&gt;</span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;">#<font style="color: rgb(255, 0, 0);">用</font><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">add_sheet</span></span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">添加工作表（sheet）</span></div><div><span style="font-size: 16pt; font-family: 楷体;">wb.<font style="color: rgb(255, 0, 0);">add_sheet</font>('first_sheet', <font style="color: rgb(255, 0, 0);">cell_overwrite_ok</font>=True)<span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">创建sheet</span></span></div><div><span style="font-size: 16pt; font-family: 楷体;">cs = wb.<font style="color: rgb(255, 0, 0);">get_active_sheet</font>()#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">获取当前活动工作表号</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(cs)#<font style="color: rgb(255, 0, 0);">sheet页的编号</font></span></div><div><span style="font-size: 16pt; font-family: 楷体;">0</span></div><div><span style="font-size: 16pt; font-family: 楷体;">ws_1 = wb.<font style="color: rgb(255, 0, 0);">get_sheet</font>(cs)#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">获取当前工作表</span></div><div><span style="font-size: 16pt; font-family: 楷体;">ws_2 = wb.<font style="color: rgb(255, 0, 0);">add_sheet</font>('second_sheet')#<font style="color: rgb(255, 0, 0);">创建sheet</font></span></div><div><span style="font-size: 16pt; font-family: 楷体;">data = np.arange(1, 65).reshape((8, 8))</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(data)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">[[ 1  2  3  4  5  6  7  8]</span></div><div><span style="font-size: 16pt; font-family: 楷体;">[ 9 10 11 12 13 14 15 16]</span></div><div><span style="font-size: 16pt; font-family: 楷体;">[17 18 19 20 21 22 23 24]</span></div><div><span style="font-size: 16pt; font-family: 楷体;">[25 26 27 28 29 30 31 32]</span></div><div><span style="font-size: 16pt; font-family: 楷体;">[33 34 35 36 37 38 39 40]</span></div><div><span style="font-size: 16pt; font-family: 楷体;">[41 42 43 44 45 46 47 48]</span></div><div><span style="font-size: 16pt; font-family: 楷体;">[49 50 51 52 53 54 55 56]</span></div><div><span style="font-size: 16pt; font-family: 楷体;">[57 58 59 60 61 62 63 64]]</span></div><div><span style="font-family: 楷体; font-size: 16pt;">print(data.<font style="color: rgb(255, 0, 0);">shape</font>)#<font style="color: rgb(255, 0, 0);">numpy数组的行，列</font></span></div><div><span style="font-family: 楷体; font-size: 16pt;">(8, 8)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">for c in range(data.shape[0]):</span></div><div><span style="font-size: 16pt; font-family: 楷体;">    for r in range(data.shape[1]):</span></div><div><span style="font-size: 16pt; font-family: 楷体;">        ws_1.<font style="color: rgb(255, 0, 0);">write</font>(r, c,100)#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">r行，c列,100值</span></div><div><span style="font-size: 16pt; font-family: 楷体;">        ws_2.<font style="color: rgb(255, 0, 0);">write</font>(r, c,100)</span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;">wb.<font style="color: rgb(255, 0, 0);">save</font>('workbook.xls')#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">保存工作表到workbook.xls文件</span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">#读取xls工作簿</span></div><div><span style="font-size: 16pt; font-family: 楷体;">book = xlrd.</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">open_workbook</span><span style="font-size: 16pt; font-family: 楷体;">('workbook.xls')#<font style="color: rgb(255, 0, 0);">打开xls工作簿</font></span></div><div><span style="font-size: 16pt; font-family: 楷体;">ls = book.<font style="color: rgb(255, 0, 0);">sheet_names</font>()#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">获取全部sheet名</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(type(ls))#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">list类型</span></div><div><span style="font-size: 16pt; font-family: 楷体;">&lt;class 'list'&gt;</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(ls)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">['first_sheet', 'second_sheet']</span></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">通过sheet_by_name获取工作名对应的工作表</span></div><div><span style="font-size: 16pt; font-family: 楷体;">sheet_1 = book.<font style="color: rgb(255, 0, 0);">sheet_by_name</font>('first_sheet')</span></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">通过sheet_by_index获取工作索引对应的工作表</span></div><div><span style="font-size: 16pt; font-family: 楷体;">sheet_2 = book.<font style="color: rgb(255, 0, 0);">sheet_by_index</font>(1)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(sheet_1)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">&lt;xlrd.sheet.Sheet object at 0x000000000B2E7588&gt;</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(sheet_2.name)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">second_sheet</span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">sheet_1的列数和行数</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(sheet_1.<font style="color: rgb(255, 0, 0);">ncols</font>, sheet_1.<font style="color: rgb(255, 0, 0);">nrows</font>)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">8 8</span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;">#<font style="color: rgb(255, 0, 0);">读取</font></span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">工作表的内容</span></div><div><span style="font-size: 16pt; font-family: 楷体;">#<font style="color: rgb(255, 0, 0);">根据行、列</font><font style="color: rgb(255, 0, 0);">读取元素值</font></span></div><div><span style="font-size: 16pt; font-family: 楷体;">cl = sheet_1.<font style="color: rgb(255, 0, 0);">cell</font>(0, 0)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(cl)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">number:100.0</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(cl.<font style="color: rgb(255, 0, 0);">value</font>)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">100.0</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(cl.<font style="color: rgb(255, 0, 0);">ctype</font>)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">2</span></div><div><img src="四、Pandas读写Excel(xlrd、xlwt读写Excel)_files/Image.png" type="image/png" data-filename="Image.png" style="font-family: 楷体; font-size: 16pt;" width="501"/></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">根据行号读取行内容</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(sheet_2.<font style="color: rgb(255, 0, 0);">row</font>(3))#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">第4行</span></div><div><span style="font-size: 16pt; font-family: 楷体;">[number:100.0, number:100.0, number:100.0, number:100.0, number:100.0, number:100.0, number:100.0, number:100.0]</span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">根据列号读取列内容</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(sheet_2.<font style="color: rgb(255, 0, 0);">col</font>(3))#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">第4列</span></div><div><span style="font-size: 16pt; font-family: 楷体;">[number:100.0, number:100.0, number:100.0, number:100.0, number:100.0, number:100.0, number:100.0, number:100.0]</span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">选择读取多行、多列数据</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(sheet_1.col_values(3, start_rowx=3, end_rowx=7))<span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">截取第4列的第3行到第7行的数据</span></span></div><div><span style="font-size: 16pt; font-family: 楷体;">[100.0, 100.0, 100.0, 100.0]</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(sheet_1.row_values(3, start_colx=3, end_colx=7))</span></div><div><span style="font-size: 16pt; font-family: 楷体;">[100.0, 100.0, 100.0, 100.0]</span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">使用pandas读取</span></div><div><span style="font-size: 16pt; font-family: 楷体;">xls_file=pd.<font style="color: rgb(255, 0, 0);">ExcelFile</font>('workbook.xls')</span></div><div><span style="font-size: 16pt; font-family: 楷体;">table=xls_file.<font style="color: rgb(255, 0, 0);">parse</font>('first_sheet')#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">利用pandas将xls文件内容转换成DataFrame类型数据</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(type(table))</span></div><div><span style="font-size: 16pt; font-family: 楷体;">&lt;class 'pandas.core.frame.DataFrame'&gt;</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(table)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">   100  100.1  100.2  100.3  100.4  100.5  100.6  100.7</span></div><div><span style="font-size: 16pt; font-family: 楷体;">0  100    100    100    100    100    100    100    100</span></div><div><span style="font-size: 16pt; font-family: 楷体;">1  100    100    100    100    100    100    100    100</span></div><div><span style="font-size: 16pt; font-family: 楷体;">2  100    100    100    100    100    100    100    100</span></div><div><span style="font-size: 16pt; font-family: 楷体;">3  100    100    100    100    100    100    100    100</span></div><div><span style="font-size: 16pt; font-family: 楷体;">4  100    100    100    100    100    100    100    100</span></div><div><span style="font-size: 16pt; font-family: 楷体;">5  100    100    100    100    100    100    100    100</span></div><div><span style="font-size: 16pt; font-family: 楷体;">6  100    100    100    100    100    100    100    100</span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">#JSON数据</span></div><div><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">#三个双引号表示字符串，用于字符串的多行情况。</span></div><div><span style="font-size: 16pt; font-family: 楷体;">obj = &quot;&quot;&quot;</span></div><div><span style="font-size: 16pt; font-family: 楷体;">{&quot;name&quot;: &quot;Wes&quot;,</span></div><div><span style="font-size: 16pt; font-family: 楷体;">&quot;places_lived&quot;: [&quot;United States&quot;, &quot;Spain&quot;, &quot;Germany&quot;],</span></div><div><span style="font-size: 16pt; font-family: 楷体;">&quot;pet&quot;: null,</span></div><div><span style="font-size: 16pt; font-family: 楷体;">&quot;siblings&quot;: [{&quot;name&quot;: &quot;Scott&quot;, &quot;age&quot;: 25, &quot;pet&quot;: &quot;Zuko&quot;},</span></div><div><span style="font-size: 16pt; font-family: 楷体;">              {&quot;name&quot;: &quot;Katie&quot;, &quot;age&quot;: 33, &quot;pet&quot;: &quot;Cisco&quot;}]</span></div><div><span style="font-size: 16pt; font-family: 楷体;">}</span></div><div><span style="font-size: 16pt; font-family: 楷体;">&quot;&quot;&quot;</span></div><div><span style="font-size: 16pt; font-family: 楷体;">import json</span></div><div><span style="font-size: 16pt; font-family: 楷体;">result = json.loads(obj)#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">将字符串内容转换成Python内容</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(type(result))</span></div><div><span style="font-size: 16pt; font-family: 楷体;">&lt;class 'dict'&gt;</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(result)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">{'name': 'Wes', 'places_lived': ['United States', 'Spain', 'Germany'], 'pet': None, 'siblings': [{'name': 'Scott', 'age': 25, 'pet': 'Zuko'}, {'name': 'Katie', 'age': 33, 'pet': 'Cisco'}]}</span></div><div><span style="font-size: 16pt; font-family: 楷体;">asjson = json.dumps(result)#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">将Python内容转成字符串内容</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(type(asjson))</span></div><div><span style="font-size: 16pt; font-family: 楷体;">&lt;class 'str'&gt;</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(asjson)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">{&quot;name&quot;: &quot;Wes&quot;, &quot;places_lived&quot;: [&quot;United States&quot;, &quot;Spain&quot;, &quot;Germany&quot;], &quot;pet&quot;: null, &quot;siblings&quot;: [{&quot;name&quot;: &quot;Scott&quot;, &quot;age&quot;: 25, &quot;pet&quot;: &quot;Zuko&quot;}, {&quot;name&quot;: &quot;Katie&quot;, &quot;age&quot;: 33, &quot;pet&quot;: &quot;Cisco&quot;}]}</span></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">将键值对转换成DataFrame类型。截取一部分内容</span></div><div><span style="font-size: 16pt; font-family: 楷体;">siblings = DataFrame(result['siblings'], columns=['name', 'age'])</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(siblings)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">    name  age</span></div><div><span style="font-size: 16pt; font-family: 楷体;">0  Scott   25</span></div><div><span style="font-size: 16pt; font-family: 楷体;">1  Katie   33</span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">二进制数据格式</span></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">pickle</span></div><div><span style="font-size: 16pt; font-family: 楷体;">frame = pd.read_csv('ex1.csv')#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">读取csv内容</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(type(frame))</span></div><div><span style="font-size: 16pt; font-family: 楷体;">&lt;class 'pandas.core.frame.DataFrame'&gt;</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(frame)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">   a   b   c   d message</span></div><div><span style="font-size: 16pt; font-family: 楷体;">0  1   2   3   4   hello</span></div><div><span style="font-size: 16pt; font-family: 楷体;">1  5   6   7   8   world</span></div><div><span style="font-size: 16pt; font-family: 楷体;">2  9  10  11  12     foo</span></div><div><span style="font-size: 16pt; font-family: 楷体;">frame.<font style="color: rgb(255, 0, 0);">to_pickle</font>('frame_pickle')#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">序列化DataFrame数据</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(pd.<font style="color: rgb(255, 0, 0);">read_pickle</font>('frame_pickle'))#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">反序列化数据</span></div><div><span style="font-size: 16pt; font-family: 楷体;">   a   b   c   d message</span></div><div><span style="font-size: 16pt; font-family: 楷体;">0  1   2   3   4   hello</span></div><div><span style="font-size: 16pt; font-family: 楷体;">1  5   6   7   8   world</span></div><div><span style="font-size: 16pt; font-family: 楷体;">2  9  10  11  12     foo</span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">使用HTML和Web API</span></div><div><span style="font-size: 16pt; font-family: 楷体;">import</span> <span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">requests</span></div><div><span style="font-size: 16pt; font-family: 楷体;">import</span> <span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">json</span></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">url = '</span><a href="https://api.github.com/repos/pydata/pandas/milestones/28/labels'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pydata/pandas/milestones/28/labels'</a><span style="font-size: 16pt; font-family: 楷体;">;</span></div><div><span style="font-size: 16pt; font-family: 楷体;">resp = requests.get(url)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(type(resp))</span></div><div><span style="font-size: 16pt; font-family: 楷体;">&lt;class 'requests.models.Response'&gt;</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(resp)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">&lt;Response [200]&gt;</span></div><div><span style="font-size: 16pt; font-family: 楷体;">data=json.<font style="color: rgb(255, 0, 0);">loads</font>(resp.text)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(type(data))</span></div><div><span style="font-size: 16pt; font-family: 楷体;">&lt;class 'list'&gt;</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(data)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">[{'id': 76811, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/Bug'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/Bug'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'Bug', 'color': 'e10c02', 'default': False}, {'id': 76812, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/Enhancement'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/Enhancement'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'Enhancement', 'color': '4E9A06', 'default': False}, {'id': 127681, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/Refactor'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/Refactor'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'Refactor', 'color': 'FCE94F', 'default': False}, {'id': 129350, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/Build'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/Build'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'Build', 'color': '75507B', 'default': False}, {'id': 134699, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/Docs'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/Docs'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'Docs', 'color': '3465A4', 'default': False}, {'id': 211840, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/Timeseries'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/Timeseries'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'Timeseries', 'color': 'AFEEEE', 'default': False}, {'id': 233160, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/Groupby'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/Groupby'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'Groupby', 'color': '729FCF', 'default': False}, {'id': 2301354, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/Data%20IO'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/Data%20IO'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'Data IO', 'color': '06909A', 'default': False}, {'id': 2413328, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/Visualization'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/Visualization'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'Visualization', 'color': '8AE234', 'default': False}, {'id': 2822098, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/Indexing'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/Indexing'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'Indexing', 'color': '0b02e1', 'default': False}, {'id': 2822342, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/Missing-data'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/Missing-data'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'Missing-data', 'color': 'd7e102', 'default': False}, {'id': 8935311, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/Performance'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/Performance'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'Performance', 'color': 'a10c02', 'default': False}, {'id': 13098779, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/Reshaping'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/Reshaping'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'Reshaping', 'color': '02d7e1', 'default': False}, {'id': 31404521, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/Dtypes'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/Dtypes'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'Dtypes', 'color': 'e102d8', 'default': False}, {'id': 32933285, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/Admin'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/Admin'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'Admin', 'color': 'DDDDDD', 'default': False}, {'id': 35818298, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/API%20Design'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/API%20Design'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'API Design', 'color': 'AD7FA8', 'default': False}, {'id': 42670965, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/Error%20Reporting'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/Error%20Reporting'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'Error Reporting', 'color': 'ffa0ff', 'default': False}, {'id': 47223669, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/Numeric'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/Numeric'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'Numeric', 'color': '006b75', 'default': False}, {'id': 47229171, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/IO%20CSV'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/IO%20CSV'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'IO CSV', 'color': '5319e7', 'default': False}, {'id': 47232590, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/IO%20SQL'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/IO%20SQL'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'IO SQL', 'color': '5319e7', 'default': False}, {'id': 48070600, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/CI'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/CI'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'CI', 'color': 'a2bca7', 'default': False}, {'id': 49094459, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/Internals'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/Internals'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'Internals', 'color': 'fbca04', 'default': False}, {'id': 49597148, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/Timedelta'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/Timedelta'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'Timedelta', 'color': '5319e7', 'default': False}, {'id': 53181044, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/Frequency'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/Frequency'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'Frequency', 'color': '0052cc', 'default': False}, {'id': 57186974, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/Windows'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/Windows'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'Windows', 'color': 'fbca04', 'default': False}, {'id': 57296398, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/Algos'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/Algos'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'Algos', 'color': 'eb6420', 'default': False}, {'id': 60458168, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/Timezones'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/Timezones'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'Timezones', 'color': '5319e7', 'default': False}, {'id': 60635328, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/Period'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/Period'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'Period', 'color': 'eb6420', 'default': False}, {'id': 71268330, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/MultiIndex'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/MultiIndex'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'MultiIndex', 'color': '207de5', 'default': False}, {'id': 78527356, 'url': '</span><a href="https://api.github.com/repos/pandas-dev/pandas/labels/Categorical'" style="font-size: 16pt; font-family: 楷体;">https://api.github.com/repos/pandas-dev/pandas/labels/Categorical'</a><span style="font-size: 16pt; font-family: 楷体;">;, 'name': 'Categorical', 'color': 'e11d21', 'default': False}]</span></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">issue_labels = DataFrame(data)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(type(issue_labels))#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">DataFrame类型</span></div><div><span style="font-size: 16pt; font-family: 楷体;">&lt;class 'pandas.core.frame.DataFrame'&gt;</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(issue_labels)#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">数据</span></div><div><span style="font-size: 16pt; font-family: 楷体;">     color  default        id             name  \</span></div><div><span style="font-size: 16pt; font-family: 楷体;">0   e10c02    False     76811              Bug   </span></div><div><span style="font-size: 16pt; font-family: 楷体;">1   4E9A06    False     76812      Enhancement   </span></div><div><span style="font-size: 16pt; font-family: 楷体;">2   FCE94F    False    127681         Refactor   </span></div><div><span style="font-size: 16pt; font-family: 楷体;">3   75507B    False    129350            Build   </span></div><div><span style="font-size: 16pt; font-family: 楷体;">4   3465A4    False    134699             Docs   </span></div><div><span style="font-size: 16pt; font-family: 楷体;">5   AFEEEE    False    211840       Timeseries   </span></div><div><span style="font-size: 16pt; font-family: 楷体;">6   729FCF    False    233160          Groupby   </span></div><div><span style="font-size: 16pt; font-family: 楷体;">7   06909A    False   2301354          Data IO   </span></div><div><span style="font-size: 16pt; font-family: 楷体;">8   8AE234    False   2413328    Visualization   </span></div><div><span style="font-size: 16pt; font-family: 楷体;">9   0b02e1    False   2822098         Indexing   </span></div><div><span style="font-size: 16pt; font-family: 楷体;">10  d7e102    False   2822342     Missing-data   </span></div><div><span style="font-size: 16pt; font-family: 楷体;">11  a10c02    False   8935311      Performance   </span></div><div><span style="font-size: 16pt; font-family: 楷体;">12  02d7e1    False  13098779        Reshaping   </span></div><div><span style="font-size: 16pt; font-family: 楷体;">13  e102d8    False  31404521           Dtypes   </span></div><div><span style="font-size: 16pt; font-family: 楷体;">14  DDDDDD    False  32933285            Admin   </span></div><div><span style="font-size: 16pt; font-family: 楷体;">15  AD7FA8    False  35818298       API Design   </span></div><div><span style="font-size: 16pt; font-family: 楷体;">16  ffa0ff    False  42670965  Error Reporting   </span></div><div><span style="font-size: 16pt; font-family: 楷体;">17  006b75    False  47223669          Numeric   </span></div><div><span style="font-size: 16pt; font-family: 楷体;">18  5319e7    False  47229171           IO CSV   </span></div><div><span style="font-size: 16pt; font-family: 楷体;">19  5319e7    False  47232590           IO SQL   </span></div><div><span style="font-size: 16pt; font-family: 楷体;">20  a2bca7    False  48070600               CI   </span></div><div><span style="font-size: 16pt; font-family: 楷体;">21  fbca04    False  49094459        Internals   </span></div><div><span style="font-size: 16pt; font-family: 楷体;">22  5319e7    False  49597148        Timedelta   </span></div><div><span style="font-size: 16pt; font-family: 楷体;">23  0052cc    False  53181044        Frequency   </span></div><div><span style="font-size: 16pt; font-family: 楷体;">24  fbca04    False  57186974          Windows   </span></div><div><span style="font-size: 16pt; font-family: 楷体;">25  eb6420    False  57296398            Algos   </span></div><div><span style="font-size: 16pt; font-family: 楷体;">26  5319e7    False  60458168        Timezones   </span></div><div><span style="font-size: 16pt; font-family: 楷体;">27  eb6420    False  60635328           Period   </span></div><div><span style="font-size: 16pt; font-family: 楷体;">28  207de5    False  71268330       MultiIndex   </span></div><div><span style="font-size: 16pt; font-family: 楷体;">29  e11d21    False  78527356      Categorical   </span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">使用数据库</span></div><div><span style="font-size: 16pt; font-family: 楷体;">import <font style="color: rgb(255, 0, 0);">sqlite3</font></span></div><div><span style="font-size: 16pt; font-family: 楷体;">query = &quot;&quot;&quot;</span></div><div><span style="font-size: 16pt; font-family: 楷体;">CREATE TABLE test</span></div><div><span style="font-size: 16pt; font-family: 楷体;">(a VARCHAR(20), b VARCHAR(20),</span></div><div><span style="font-size: 16pt; font-family: 楷体;">c REAL,        d INTEGER</span></div><div><span style="font-size: 16pt; font-family: 楷体;">);&quot;&quot;&quot;</span></div><div><span style="font-size: 16pt; font-family: 楷体;">con = <font style="color: rgb(255, 0, 0);">sqlite3</font>.<font style="color: rgb(255, 0, 0);">connect</font>(':memory:')</span></div><div><span style="font-size: 16pt; font-family: 楷体;">con.<font style="color: rgb(255, 0, 0);">execute</font>(query)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">con.<font style="color: rgb(255, 0, 0);">commit</font>()</span></div><div><span style="font-size: 16pt; font-family: 楷体;">data = [('Atlanta', 'Georgia', 1.25, 6),</span></div><div><span style="font-size: 16pt; font-family: 楷体;">        ('Tallahassee', 'Florida', 2.6, 3),</span></div><div><span style="font-size: 16pt; font-family: 楷体;">        ('Sacramento', 'California', 1.7, 5)]</span></div><div><span style="font-size: 16pt; font-family: 楷体;">stmt = &quot;INSERT INTO test VALUES(?, ?, ?, ?)&quot;</span></div><div><span style="font-size: 16pt; font-family: 楷体;">con.executemany(stmt, data)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">con.commit()</span></div><div><span style="font-size: 16pt; font-family: 楷体;">cursor = con.execute('select * from test')</span></div><div><span style="font-size: 16pt; font-family: 楷体;">rows = cursor.fetchall()</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(rows)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">[('Atlanta', 'Georgia', 1.25, 6), ('Tallahassee', 'Florida', 2.6, 3), ('Sacramento', 'California', 1.7, 5)]</span></div><div><span style="font-size: 16pt; font-family: 楷体;">import pandas.io.sql as sql</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(sql.read_sql('select * from test', con))</span></div><div><span style="font-size: 16pt; font-family: 楷体;">Empty DataFrame</span></div><div><span style="font-size: 16pt; font-family: 楷体;">Columns: [a, b, c, d]</span></div><div><span style="font-size: 16pt; font-family: 楷体;">Index: []</span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;"><br/></span></div></span>
</div></body></html> 