<html>
<head>
  <title>三、Pandas读写csv文件</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307934 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1139"/>
<h1>三、Pandas读写csv文件</h1>

<div>
<span><div><span style="box-sizing: border-box; font-size: 16pt; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(0, 0, 0); font-family: 楷体; font-variant: normal; line-height: 18px;">三、</span><span style="box-sizing: border-box; font-size: 16pt; letter-spacing: normal; orphans: auto; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(255, 0, 0); font-family: 楷体; font-variant: normal; line-height: 18px;">Pandas读写csv文件</span></div><div><br/></div><div><img src="三、Pandas读写csv文件_files/Image.png" type="image/png" data-filename="Image.png" style="font-family: 楷体; font-size: 16pt;"/></div><div><img src="三、Pandas读写csv文件_files/Image [1].png" type="image/png" data-filename="Image.png" style="font-family: 楷体; font-size: 16pt;"/></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">import</span> <span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">numpy</span> <span style="font-size: 16pt; font-family: 楷体;">as</span> <span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">np</span></div><div><span style="font-size: 16pt; font-family: 楷体;">import</span> <span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">pandas</span> <span style="font-size: 16pt; font-family: 楷体;">as</span> <span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">pd</span></div><div><span style="font-size: 16pt; font-family: 楷体;">from</span> <span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">pandas</span> <span style="font-size: 16pt; font-family: 楷体;">import</span> <span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">Series</span><span style="font-size: 16pt; font-family: 楷体;">,</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">DataFrame</span></div><div><br/></div><div><br/></div><div><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">#文本格式数据：</span></div><div><img src="三、Pandas读写csv文件_files/Image [2].png" type="image/png" data-filename="Image.png" style="font-family: 楷体; font-size: 16pt;"/></div><div><br/></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">#<span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">read_csv方法读取CSV文件（</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">read_csv默认读取逗号文件</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">）</span></span></div><div><span style="font-size: 16pt; font-family: 楷体;">df = pd.</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">read_csv</span><span style="font-size: 16pt; font-family: 楷体;">('ex1.csv')</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(type(df))</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">#返回值类型是DataFrame类型</span></div><div><span style="font-size: 16pt; font-family: 楷体;">&lt;class 'pandas.core.frame.</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">DataFrame</span><span style="font-size: 16pt; font-family: 楷体;">'&gt;</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(df)</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">#csv内容</span></div><div><span style="font-size: 16pt; font-family: 楷体;">   a   b   c   d message</span></div><div><span style="font-size: 16pt; font-family: 楷体;">0  1   2   3   4   hello</span></div><div><span style="font-size: 16pt; font-family: 楷体;">1  5   6   7   8   world</span></div><div><span style="font-size: 16pt; font-family: 楷体;">2  9  10  11  12     foo</span></div><div><br/></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">#<span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">read_table方法</span></span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">读取CSV文件（</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">read_table读取文本，<span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">sep表示以什么区分</span></span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">）</span></div><div><span style="font-size: 16pt; font-family: 楷体;">df = pd.</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">read_table</span><span style="font-size: 16pt; font-family: 楷体;">('ex1.csv',</span> <span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">sep</span><span style="font-size: 16pt; font-family: 楷体;">=',')#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">以,区分</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(df)</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">#csv文件就是逗号文件，以,分割的数据</span></div><div><span style="font-size: 16pt; font-family: 楷体;">   a   b   c   d message</span></div><div><span style="font-size: 16pt; font-family: 楷体;">0  1   2   3   4   hello</span></div><div><span style="font-size: 16pt; font-family: 楷体;">1  5   6   7   8   world</span></div><div><span style="font-size: 16pt; font-family: 楷体;">2  9  10  11  12     foo</span></div><div><br/></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">#<span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">read_table方法</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">读取文本文件</span></span></div><div><span style="font-size: 16pt; font-family: 楷体;">df = pd.</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">read_table</span><span style="font-size: 16pt; font-family: 楷体;">('ex1.csv')</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(type(df))</span></div><div><span style="font-size: 16pt; font-family: 楷体;">&lt;class 'pandas.core.frame.DataFrame'&gt;</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(df)</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">#文本文件内容</span></div><div><span style="font-size: 16pt; font-family: 楷体;">  a,b,c,d,message</span></div><div><span style="font-size: 16pt; font-family: 楷体;">0   1,2,3,4,hello</span></div><div><span style="font-size: 16pt; font-family: 楷体;">1   5,6,7,8,world</span></div><div><span style="font-size: 16pt; font-family: 楷体;">2  9,10,11,12,foo</span></div><div><br/></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">指定第一行不是表头，是数据</span></div><div><span style="font-family: 楷体; font-size: 16pt;">df = pd.read_csv('ex1.csv',</span><span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">header</span><span style="font-family: 楷体; font-size: 16pt;">=</span><span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">None</span><span style="font-family: 楷体; font-size: 16pt;">)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(type(df))</span></div><div><span style="font-size: 16pt; font-family: 楷体;">&lt;class 'pandas.core.frame.DataFrame'&gt;</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(df)#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">第一行不是表头，是数据</span></div><div><span style="font-size: 16pt; font-family: 楷体;">   0   1   2   3        4</span></div><div><span style="font-size: 16pt; font-family: 楷体;">0  a   b   c   d  message</span></div><div><span style="font-size: 16pt; font-family: 楷体;">1  1   2   3   4    hello</span></div><div><span style="font-size: 16pt; font-family: 楷体;">2  5   6   7   8    world</span></div><div><span style="font-size: 16pt; font-family: 楷体;">3  9  10  11  12      foo</span></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">用names参数指定列表头</span></div><div><span style="font-family: 楷体; font-size: 16pt;">df = pd.</span><span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">read_csv</span><span style="font-family: 楷体; font-size: 16pt;">('ex1.csv',</span><span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">names</span><span style="font-family: 楷体; font-size: 16pt;">=['First', 'Second', 'Third', 'Fourth', 'fifth'])</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(type(df))</span></div><div><span style="font-size: 16pt; font-family: 楷体;">&lt;class 'pandas.core.frame.DataFrame'&gt;</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(df)#表头是用names指定的</span></div><div><span style="font-size: 16pt; font-family: 楷体;">  First Second Third Fourth    fifth</span></div><div><span style="font-size: 16pt; font-family: 楷体;">0     a      b     c      d  message</span></div><div><span style="font-size: 16pt; font-family: 楷体;">1     1      2     3      4    hello</span></div><div><span style="font-size: 16pt; font-family: 楷体;">2     5      6     7      8    world</span></div><div><span style="font-size: 16pt; font-family: 楷体;">3     9     10    11     12      foo</span></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">#<span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">用</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">index_col</span></span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">指定某列为行表头</span></div><div><span style="font-family: 楷体; font-size: 16pt;">df = pd.</span><span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">read_csv</span><span style="font-family: 楷体; font-size: 16pt;">('ex1.csv',</span><span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">names</span><span style="font-family: 楷体; font-size: 16pt;">=['First', 'Second', 'Third', 'Fourth', 'fifth'],</span><span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">index_col</span><span style="font-family: 楷体; font-size: 16pt;">='fifth')</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(type(df))</span></div><div><span style="font-size: 16pt; font-family: 楷体;">&lt;class 'pandas.core.frame.DataFrame'&gt;</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(df)#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">指定某列为行表头</span></div><div><span style="font-size: 16pt; font-family: 楷体;">        First Second Third Fourth</span></div><div><span style="font-size: 16pt; font-family: 楷体;">fifth                            </span></div><div><span style="font-size: 16pt; font-family: 楷体;">message     a      b     c      d</span></div><div><span style="font-size: 16pt; font-family: 楷体;">hello       1      2     3      4</span></div><div><span style="font-size: 16pt; font-family: 楷体;">world       5      6     7      8</span></div><div><span style="font-size: 16pt; font-family: 楷体;">foo         9     10    11     12</span></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">#<span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">文本格式数据：</span></span></div><div><img src="三、Pandas读写csv文件_files/Image [3].png" type="image/png" data-filename="Image.png" style="font-family: 楷体; font-size: 16pt;"/></div><div><span style="font-size: 16pt; font-family: 楷体;">parsed = pd.read_csv('csv_mindex.csv')</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(parsed)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">  key1 key2  value1  value2</span></div><div><span style="font-size: 16pt; font-family: 楷体;">0  one    a       1       2</span></div><div><span style="font-size: 16pt; font-family: 楷体;">1  one    b       3       4</span></div><div><span style="font-size: 16pt; font-family: 楷体;">2  one    c       5       6</span></div><div><span style="font-size: 16pt; font-family: 楷体;">3  one    d       7       8</span></div><div><span style="font-size: 16pt; font-family: 楷体;">4  two    a       9      10</span></div><div><span style="font-size: 16pt; font-family: 楷体;">5  two    b      11      12</span></div><div><span style="font-size: 16pt; font-family: 楷体;">6  two    c      13      14</span></div><div><span style="font-size: 16pt; font-family: 楷体;">7  two    d      15      16</span></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">用</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">index_col指定列为行</span></div><div><span style="font-family: 楷体; font-size: 16pt;">parsed = pd.</span><span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">read_csv</span><span style="font-family: 楷体; font-size: 16pt;">('csv_mindex.csv',</span> <span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">index_col</span><span style="font-family: 楷体; font-size: 16pt;">=['key1', 'key2'])#</span><span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">指定两列为行名</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(parsed)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">           value1  value2</span></div><div><span style="font-size: 16pt; font-family: 楷体;">key1 key2                </span></div><div><span style="font-size: 16pt; font-family: 楷体;">one  a          1       2</span></div><div><span style="font-size: 16pt; font-family: 楷体;">     b          3       4</span></div><div><span style="font-size: 16pt; font-family: 楷体;">     c          5       6</span></div><div><span style="font-size: 16pt; font-family: 楷体;">     d          7       8</span></div><div><span style="font-size: 16pt; font-family: 楷体;">two  a          9      10</span></div><div><span style="font-size: 16pt; font-family: 楷体;">     b         11      12</span></div><div><span style="font-size: 16pt; font-family: 楷体;">     c         13      14</span></div><div><span style="font-size: 16pt; font-family: 楷体;">     d         15      16</span></div><div><br/></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">文本格式数据：</span></div><div><img src="三、Pandas读写csv文件_files/Image [4].png" type="image/png" data-filename="Image.png" style="font-family: 楷体; font-size: 16pt;"/></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">ls = list(open('ex3.txt'))#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">将csv内容转换成list</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(ls)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">['            A         B         C\n', 'aaa -0.264438 -1.026059 -0.619500\n', 'bbb  0.927272  0.302904 -0.032399\n', 'ccc -0.264273 -0.386314 -0.217601\n', 'ddd -0.871858 -0.348382  1.100491\n']</span></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">正则表达式读取，文本内容</span></div><div><span style="font-family: 楷体; font-size: 16pt;">result = pd.</span><span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">read_table</span><span style="font-family: 楷体; font-size: 16pt;">('ex3.txt',sep='</span><span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">\s+</span><span style="font-family: 楷体; font-size: 16pt;">')</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(result)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">            A         B         C</span></div><div><span style="font-size: 16pt; font-family: 楷体;">aaa -0.264438 -1.026059 -0.619500</span></div><div><span style="font-size: 16pt; font-family: 楷体;">bbb  0.927272  0.302904 -0.032399</span></div><div><span style="font-size: 16pt; font-family: 楷体;">ccc -0.264273 -0.386314 -0.217601</span></div><div><span style="font-size: 16pt; font-family: 楷体;">ddd -0.871858 -0.348382  1.100491</span></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">文本格式数据：</span></div><div><img src="三、Pandas读写csv文件_files/Image [5].png" type="image/png" data-filename="Image.png" style="font-family: 楷体; font-size: 16pt;" width="451"/></div><div><span style="font-size: 16pt; font-family: 楷体;">#<span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">用</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">skiprows</span></span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">跳过行读取</span></div><div><span style="font-family: 楷体; font-size: 16pt;">result = pd.read_csv('ex4.csv',</span> <span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">skiprows</span><span style="font-family: 楷体; font-size: 16pt;">=[0, 2, 3])</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(result)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">   a   b   c   d message</span></div><div><span style="font-size: 16pt; font-family: 楷体;">0  1   2   3   4   hello</span></div><div><span style="font-size: 16pt; font-family: 楷体;">1  5   6   7   8   world</span></div><div><span style="font-size: 16pt; font-family: 楷体;">2  9  10  11  12     foo</span></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">文本格式数据：</span></div><div><img src="三、Pandas读写csv文件_files/Image [6].png" type="image/png" data-filename="Image.png" style="font-family: 楷体; font-size: 16pt;"/></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">查看表格内容</span></div><div><span style="font-size: 16pt; font-family: 楷体;">result = pd.read_csv('ex5.csv')</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(result)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">  something  a   b     c   d message</span></div><div><span style="font-size: 16pt; font-family: 楷体;">0       one  1   2   3.0   4     <span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 70, 53);">NaN</span></span></div><div><span style="font-family: 楷体; font-size: 16pt;">1       two  5   6   </span><span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">NaN   </span><span style="font-family: 楷体; font-size: 16pt;">8   world</span></div><div><span style="font-size: 16pt; font-family: 楷体;">2     three  9  10  11.0  12     foo</span></div><div><span style="font-size: 16pt; font-family: 楷体;">#<span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">用</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">isnull</span></span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">查看缺失值</span></div><div><span style="font-family: 楷体; font-size: 16pt;">print(pd.</span><span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">isnull</span><span style="font-family: 楷体; font-size: 16pt;">(result))</span></div><div><span style="font-size: 16pt; font-family: 楷体;">   something      a      b      c      d  message</span></div><div><span style="font-size: 16pt; font-family: 楷体;">0      False  False  False  False  False     <span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">True</span></span></div><div><span style="font-family: 楷体; font-size: 16pt;">1      False  False  False   </span><span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">True  </span><span style="font-family: 楷体; font-size: 16pt;">False    False</span></div><div><span style="font-size: 16pt; font-family: 楷体;">2      False  False  False  False  False    False</span></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">na_values里的值认为是缺省值</span></div><div><span style="font-family: 楷体; font-size: 16pt;">result = pd.read_csv('ex5.csv',</span> <span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">na_values</span><span style="font-family: 楷体; font-size: 16pt;">=['3'])</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(result)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">  something  a   b     c   d message</span></div><div><span style="font-family: 楷体; font-size: 16pt;">0       one  1   2   </span><span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">NaN   </span><span style="font-family: 楷体; font-size: 16pt;">4     NaN</span></div><div><span style="font-size: 16pt; font-family: 楷体;">1       two  5   6   NaN   8   world</span></div><div><span style="font-size: 16pt; font-family: 楷体;">2     three  9  10  11.0  12     foo</span></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">键值对</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">指定缺失值，键指行，值是内容</span></div><div><span style="font-size: 16pt; font-family: 楷体;">sentinels = {'message': ['foo', 'NA'], 'something': ['two']}</span></div><div><span style="font-family: 楷体; font-size: 16pt;">result =pd.read_csv('ex5.csv',</span> <span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">na_values</span><span style="font-family: 楷体; font-size: 16pt;">=sentinels)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(result)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">  something  a   b     c   d message</span></div><div><span style="font-size: 16pt; font-family: 楷体;">0       one  1   2   3.0   4     NaN</span></div><div><span style="font-family: 楷体; font-size: 16pt;">1       </span><span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">NaN  </span><span style="font-family: 楷体; font-size: 16pt;">5   6   NaN   8   world</span></div><div><span style="font-size: 16pt; font-family: 楷体;">2     three  9  10  11.0  12     <span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">NaN</span></span></div><div><br/></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">文本格式数据：</span></div><div><img src="三、Pandas读写csv文件_files/Image [7].png" type="image/png" data-filename="Image.png" style="font-family: 楷体; font-size: 16pt;"/></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">逐行读取文本文件</span></div><div><span style="font-size: 16pt; font-family: 楷体;">result = pd.read_csv('ex6.csv')</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(result)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">          one       two     three      four key</span></div><div><span style="font-size: 16pt; font-family: 楷体;">0     0.467976 -0.038649 -0.295344 -1.824726   L</span></div><div><span style="font-size: 16pt; font-family: 楷体;">1    -0.358893  1.404453  0.704965 -0.200638   B</span></div><div><span style="font-size: 16pt; font-family: 楷体;">2    -0.501840  0.659254 -0.421691 -0.057688   G</span></div><div><span style="font-size: 16pt; font-family: 楷体;">3     0.204886  1.074134  1.388361 -0.982404   R</span></div><div><span style="font-size: 16pt; font-family: 楷体;">4     0.354628 -0.133116  0.283763 -0.837063   Q</span></div><div><span style="font-size: 16pt; font-family: 楷体;">...        ...       ...       ...       ...  ..</span></div><div><span style="font-size: 16pt; font-family: 楷体;">9995  2.311896 -0.417070 -1.409599 -0.515821   L</span></div><div><span style="font-size: 16pt; font-family: 楷体;">9996 -0.479893 -0.650419  0.745152 -0.646038   E</span></div><div><span style="font-size: 16pt; font-family: 楷体;">9997  0.523331  0.787112  0.486066  1.093156   K</span></div><div><span style="font-size: 16pt; font-family: 楷体;">9998 -0.362559  0.598894 -1.843201  0.887292   G</span></div><div><span style="font-size: 16pt; font-family: 楷体;">9999 -0.096376 -1.012999 -0.657431 -0.573315   0</span></div><div><span style="font-size: 16pt; font-family: 楷体;">[10000 rows x 5 columns]</span></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">只读取前5行</span></div><div><span style="font-family: 楷体; font-size: 16pt;">result = pd.read_csv('ex6.csv',</span> <span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">nrows</span><span style="font-family: 楷体; font-size: 16pt;">=5)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(result)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">        one       two     three      four key</span></div><div><span style="font-size: 16pt; font-family: 楷体;">0  0.467976 -0.038649 -0.295344 -1.824726   L</span></div><div><span style="font-size: 16pt; font-family: 楷体;">1 -0.358893  1.404453  0.704965 -0.200638   B</span></div><div><span style="font-size: 16pt; font-family: 楷体;">2 -0.501840  0.659254 -0.421691 -0.057688   G</span></div><div><span style="font-size: 16pt; font-family: 楷体;">3  0.204886  1.074134  1.388361 -0.982404   R</span></div><div><span style="font-size: 16pt; font-family: 楷体;">4  0.354628 -0.133116  0.283763 -0.837063   Q</span></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">逐块读取文件</span></div><div><span style="font-family: 楷体; font-size: 16pt;">chunker = pd.read_csv('ex6.csv',</span> <span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">chunksize</span><span style="font-family: 楷体; font-size: 16pt;">=1000)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(chunker)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">&lt;pandas.io.parsers.TextFileReader object at 0x00000000023E3240&gt;</span></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">#<span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">用DataFrame包的to_csv方法写</span></span><span style="font-size: 16pt;"><span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">文件</span></span></div><div><span style="font-size: 16pt; font-family: 楷体;">data = pd.read_csv('ex5.csv')</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(data)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">  something  a   b     c   d message</span></div><div><span style="font-size: 16pt; font-family: 楷体;">0       one  1   2   3.0   4     NaN</span></div><div><span style="font-size: 16pt; font-family: 楷体;">1       two  5   6   NaN   8   world</span></div><div><span style="font-size: 16pt; font-family: 楷体;">2     three  9  10  11.0  12     foo</span></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">将ex5.csv内容写到out.csv里，创建out.csv</span></div><div><span style="font-family: 楷体; font-size: 16pt;">data.</span><span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">to_csv</span><span style="font-family: 楷体; font-size: 16pt;">('out1.csv')</span></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">以|区分csv数据内容</span></div><div><span style="font-family: 楷体; font-size: 16pt;">data.</span><span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">to_csv</span><span style="font-family: 楷体; font-size: 16pt;">(</span><span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">sys</span><span style="font-family: 楷体; font-size: 16pt;">.</span><span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">stdout</span><span style="font-family: 楷体; font-size: 16pt;">,</span> <span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">sep</span><span style="font-family: 楷体; font-size: 16pt;">='|')</span></div><div><span style="font-size: 16pt; font-family: 楷体;">|something|a|b|c|d|message</span></div><div><span style="font-size: 16pt; font-family: 楷体;">0|one|1|2|3.0|4|</span></div><div><span style="font-size: 16pt; font-family: 楷体;">1|two|5|6||8|world</span></div><div><span style="font-size: 16pt; font-family: 楷体;">2|three|9|10|11.0|12|foo</span></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">以,区分csv数据内容</span></div><div><span style="font-family: 楷体; font-size: 16pt;">data.</span><span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">to_csv</span><span style="font-family: 楷体; font-size: 16pt;">(sys.stdout,</span> <span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">na_rep</span><span style="font-family: 楷体; font-size: 16pt;">='NULL')</span></div><div><span style="font-size: 16pt; font-family: 楷体;">,something,a,b,c,d,message</span></div><div><span style="font-size: 16pt; font-family: 楷体;">0,one,1,2,3.0,4,NULL</span></div><div><span style="font-size: 16pt; font-family: 楷体;">1,two,5,6,NULL,8,world</span></div><div><span style="font-size: 16pt; font-family: 楷体;">2,three,9,10,11.0,12,foo</span></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">去掉行表头，只要指定列</span></div><div><span style="font-family: 楷体; font-size: 16pt;">data.to_csv(sys.stdout,</span> <span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">index</span><span style="font-family: 楷体; font-size: 16pt;">=False,</span> <span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">columns</span><span style="font-family: 楷体; font-size: 16pt;">=['a', 'b', 'c'])</span></div><div><span style="font-size: 16pt; font-family: 楷体;">a,b,c</span></div><div><span style="font-size: 16pt; font-family: 楷体;">1,2,3.0</span></div><div><span style="font-size: 16pt; font-family: 楷体;">5,6,</span></div><div><span style="font-size: 16pt; font-family: 楷体;">9,10,11.0</span></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">创建日期数据</span></div><div><span style="font-size: 16pt; font-family: 楷体;">dates = pd.date_range('1/1/2000', periods=7)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(dates)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">DatetimeIndex(['2000-01-01', '2000-01-02', '2000-01-03', '2000-01-04',</span></div><div><span style="font-size: 16pt; font-family: 楷体;">               '2000-01-05', '2000-01-06', '2000-01-07'],</span></div><div><span style="font-size: 16pt; font-family: 楷体;">              dtype='datetime64[ns]', freq='D')</span></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">保存成Series类型，索引是dates.</span></div><div><span style="font-family: 楷体; font-size: 16pt;">ts = Series(np.arange(7),</span> <span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">index</span><span style="font-family: 楷体; font-size: 16pt;">=dates)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(ts)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">2000-01-01    0</span></div><div><span style="font-size: 16pt; font-family: 楷体;">2000-01-02    1</span></div><div><span style="font-size: 16pt; font-family: 楷体;">2000-01-03    2</span></div><div><span style="font-size: 16pt; font-family: 楷体;">2000-01-04    3</span></div><div><span style="font-size: 16pt; font-family: 楷体;">2000-01-05    4</span></div><div><span style="font-size: 16pt; font-family: 楷体;">2000-01-06    5</span></div><div><span style="font-size: 16pt; font-family: 楷体;">2000-01-07    6</span></div><div><span style="font-size: 16pt; font-family: 楷体;">Freq: D, dtype: int32</span></div><div><span style="font-family: 楷体; font-size: 16pt;">ts.</span><span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">to_csv</span><span style="font-family: 楷体; font-size: 16pt;">('tseries.csv')</span></div><div><br/></div><div><br/></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">手工处理分隔符格式</span></div><div><img src="三、Pandas读写csv文件_files/Image [8].png" type="image/png" data-filename="Image.png" style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);" width="853"/></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">文本格式数据：</span></div><div><img src="三、Pandas读写csv文件_files/Image [9].png" type="image/png" data-filename="Image.png" style="font-family: 楷体; font-size: 16pt;"/></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">手工处理分隔符格式</span></div><div><span style="font-family: 楷体; font-size: 16pt;">import</span> <span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">csv</span> <span style="font-family: 楷体; font-size: 16pt;">#</span><span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">用csv包处理文本数据</span></div><div><span style="font-size: 16pt; font-family: 楷体;">f = open('ex7.csv')</span></div><div><span style="font-family: 楷体; font-size: 16pt;">reader = csv.</span><span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">reader</span><span style="font-family: 楷体; font-size: 16pt;">(f)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(reader)#类型</span></div><div><span style="font-size: 16pt; font-family: 楷体;">&lt;_csv.reader object at 0x000000000B1136C8&gt;</span></div><div><span style="font-size: 16pt; font-family: 楷体;">for line in reader:</span></div><div><span style="font-size: 16pt; font-family: 楷体;">    print(line)#reader类型的行类型</span></div><div><span style="font-size: 16pt; font-family: 楷体;">['a', 'b', 'c']</span></div><div><span style="font-size: 16pt; font-family: 楷体;">['1', '2', '3']</span></div><div><span style="font-size: 16pt; font-family: 楷体;">['1', '2', '3', '4']</span></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">去除不标准的列</span></div><div><span style="font-family: 楷体; font-size: 16pt;">lines = list(csv.</span><span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">reader</span><span style="font-family: 楷体; font-size: 16pt;">(open('ex7.csv')))#</span><span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">lines是二维列表</span></div><div><span style="font-size: 16pt; font-family: 楷体;">header, values = lines[0], lines[1:]#<span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">切片</span></span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(header)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">['a', 'b', 'c']</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(values)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">[['1', '2', '3'], ['1', '2', '3', '4']]</span></div><div><span style="font-family: 楷体; font-size: 16pt;">data_dict = {h: v for h, v in</span> <span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">zip</span><span style="font-family: 楷体; font-size: 16pt;">(header,</span> <span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">zip</span><span style="font-family: 楷体; font-size: 16pt;">(*values))}#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">根据行和列转换成字典形式</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(data_dict)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">{'a': ('1', '1'), 'b': ('2', '2'), 'c': ('3', '3')}</span></div><div><br/></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">定义写入文件字符的区分符号</span></div><div><span style="font-size: 16pt; font-family: 楷体;">class my_dialect(csv.Dialect):</span></div><div><span style="font-size: 16pt; font-family: 楷体;">    lineterminator = '\n'</span></div><div><span style="font-size: 16pt; font-family: 楷体;">    </span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">delimiter</span> <span style="font-size: 16pt; font-family: 楷体;">= '.'#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">字段区分符</span></div><div><span style="font-size: 16pt; font-family: 楷体;">    quotechar = '&quot;'</span></div><div><span style="font-size: 16pt; font-family: 楷体;">    quoting = csv.QUOTE_MINIMAL</span></div><div><span style="font-size: 16pt; font-family: 楷体;">with open('mydata.csv', 'w') as f:</span></div><div><span style="font-family: 楷体; font-size: 16pt;">    writer = csv.</span><span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">writer</span><span style="font-family: 楷体; font-size: 16pt;">(f, dialect=my_dialect)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">    writer.</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">writerow</span><span style="font-size: 16pt; font-family: 楷体;">(('one', 'two', 'three'))#</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">写入行</span></div><div><span style="font-size: 16pt; font-family: 楷体;">    writer.</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">writerow</span><span style="font-size: 16pt; font-family: 楷体;">(('1', '2', '3'))</span></div><div><span style="font-size: 16pt; font-family: 楷体;">    writer.</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">writerow</span><span style="font-size: 16pt; font-family: 楷体;">(('4', '5', '6'))</span></div><div><span style="font-size: 16pt; font-family: 楷体;">    writer.</span><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">writerow</span><span style="font-size: 16pt; font-family: 楷体;">(('7', '8', '9'))</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(pd.read_table('mydata.csv', sep='.'))</span></div><div><span style="font-size: 16pt; font-family: 楷体;">   one  two  three</span></div><div><span style="font-size: 16pt; font-family: 楷体;">0    1    2      3</span></div><div><span style="font-size: 16pt; font-family: 楷体;">1    4    5      6</span></div><div><span style="font-size: 16pt; font-family: 楷体;">2    7    8      9</span></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></span>
</div></body></html> 