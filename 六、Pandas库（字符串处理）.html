<html>
<head>
  <title>六、Pandas库（字符串处理）</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307934 (zh-CN, DDL); Windows/6.1.1 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1181"/>
<h1>六、Pandas库（字符串处理）</h1>

<div>
<span><div><span style="font-family: 楷体; font-size: 16pt;">#</span><span style="font-family: 楷体; font-size: 16pt; color: rgb(255, 0, 0);">字符串操作</span></div><div><img src="六、Pandas库（字符串处理）_files/Image.png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;"># -*- coding: utf-8 -*-</span></div><div><span style="font-size: 16pt; font-family: 楷体;">from __future__ import division</span></div><div><span style="font-size: 16pt; font-family: 楷体;">import numpy as np</span></div><div><span style="font-size: 16pt; font-family: 楷体;">import os</span></div><div><span style="font-size: 16pt; font-family: 楷体;">import <font style="color: rgb(255, 0, 0);">matplotlib.pyplot</font> as <font style="color: rgb(255, 0, 0);">plt</font></span></div><div><span style="font-size: 16pt; font-family: 楷体;">from <font style="color: rgb(255, 0, 0);">scipy.interpolate</font> import <font style="color: rgb(255, 0, 0);">lagrange</font> #导入拉格朗日插值函数</span></div><div><span style="font-size: 16pt; font-family: 楷体;">from <font style="color: rgb(255, 0, 0);">pandas</font> import <font style="color: rgb(255, 0, 0);">Series</font>, <font style="color: rgb(255, 0, 0);">DataFrame</font></span></div><div><span style="font-size: 16pt; font-family: 楷体;">import <font style="color: rgb(255, 0, 0);">pandas</font> as <font style="color: rgb(255, 0, 0);">pd</font></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;">#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">pandas中矢量化的字符串函数</span></div><div><span style="font-size: 16pt; font-family: 楷体;">data = {'Dave': '</span><a href="mailto:dave@google.com" style="font-size: 16pt; font-family: 楷体;">dave@google.com</a><span style="font-size: 16pt; font-family: 楷体;">', 'Steve': '</span><a href="mailto:steve@gmail.com" style="font-size: 16pt; font-family: 楷体;">steve@gmail.com</a><span style="font-size: 16pt; font-family: 楷体;">',</span></div><div><span style="font-size: 16pt; font-family: 楷体;">        'Rob': '</span><a href="mailto:rob@gmail.com" style="font-size: 16pt; font-family: 楷体;">rob@gmail.com</a><span style="font-size: 16pt; font-family: 楷体;">', 'Wes': np.nan}</span></div><div><span style="font-size: 16pt; font-family: 楷体;">data = Series(data)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(data)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">Dave     </span><a href="mailto:dave@google.com" style="font-size: 16pt; font-family: 楷体;">dave@google.com</a></div><div><span style="font-size: 16pt; font-family: 楷体;">Rob        </span><a href="mailto:rob@gmail.com" style="font-size: 16pt; font-family: 楷体;">rob@gmail.com</a></div><div><span style="font-size: 16pt; font-family: 楷体;">Steve    </span><a href="mailto:steve@gmail.com" style="font-size: 16pt; font-family: 楷体;">steve@gmail.com</a></div><div><span style="font-size: 16pt; font-family: 楷体;">Wes                  NaN</span></div><div><span style="font-size: 16pt; font-family: 楷体;">dtype: object</span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(data.isnull())</span></div><div><span style="font-size: 16pt; font-family: 楷体;">Dave     False</span></div><div><span style="font-size: 16pt; font-family: 楷体;">Rob      False</span></div><div><span style="font-size: 16pt; font-family: 楷体;">Steve    False</span></div><div><span style="font-size: 16pt; font-family: 楷体;">Wes       True</span></div><div><span style="font-size: 16pt; font-family: 楷体;">dtype: bool</span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(data.str.<font style="color: rgb(255, 0, 0);">contains</font>('gmail'))#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">对Series中的元素处理，判断是否包含gmail</span></div><div><span style="font-family: 楷体; font-size: 16pt;">Dave     False</span></div><div><span style="font-family: 楷体; font-size: 16pt;">Rob       True</span></div><div><span style="font-family: 楷体; font-size: 16pt;">Steve     True</span></div><div><span style="font-family: 楷体; font-size: 16pt;">Wes        NaN</span></div><div><span style="font-family: 楷体; font-size: 16pt;">dtype: object</span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; color: rgb(255, 0, 0); font-family: 楷体;">#正则表达式（Re模块）</span></div><div><br/></div><div><img src="六、Pandas库（字符串处理）_files/Image [1].png" type="image/png" data-filename="Image.png" style="font-family: 楷体;"/></div><div><img src="六、Pandas库（字符串处理）_files/Image [2].png" type="image/png" data-filename="Image.png" style="font-family: 楷体; font-size: 16pt;"/></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">import</span> <span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">re</span></div><div><span style="font-size: 16pt; font-family: 楷体;">text = &quot;foo    bar\t baz  \tqux&quot;</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(re.split('\s+', text))</span></div><div><span style="font-size: 16pt; font-family: 楷体;">['foo', 'bar', 'baz', 'qux']</span></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">regex = re.compile('\s+')#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">先将正则表达式编译</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(regex.split(text))#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">调用正则表达式的split方法实一样的效果</span></div><div><span style="font-size: 16pt; font-family: 楷体;">['foo', 'bar', 'baz', 'qux']</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(regex.findall(text))</span></div><div><span style="font-size: 16pt; font-family: 楷体;">['    ', '\t ', '  \t']</span></div><div><br/></div><div><span style="font-size: 16pt; font-family: 楷体;">#2</span></div><div><span style="font-size: 16pt; font-family: 楷体;">text = &quot;&quot;&quot;Dave</span> <a href="mailto:dave@google.com" style="font-size: 16pt; font-family: 楷体;">dave@google.com</a></div><div><span style="font-size: 16pt; font-family: 楷体;">Steve</span> <a href="mailto:steve@gmail.com" style="font-size: 16pt; font-family: 楷体;">steve@gmail.com</a></div><div><span style="font-size: 16pt; font-family: 楷体;">Rob</span> <a href="mailto:rob@gmail.com" style="font-size: 16pt; font-family: 楷体;">rob@gmail.com</a></div><div><span style="font-size: 16pt; font-family: 楷体;">Ryan</span> <a href="mailto:ryan@yahoo.com" style="font-size: 16pt; font-family: 楷体;">ryan@yahoo.com</a></div><div><span style="font-size: 16pt; font-family: 楷体;">&quot;&quot;&quot;</span></div><div><span style="font-size: 16pt; font-family: 楷体;">pattern = r'[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}'</span></div><div><span style="font-size: 16pt; font-family: 楷体;"># re.IGNORECASE 的作用是使正则表达式对大小写不敏感</span></div><div><span style="font-size: 16pt; font-family: 楷体;">regex = re.compile(pattern, flags=re.IGNORECASE)#</span><span style="font-size: 16pt; font-family: 楷体; color: rgb(255, 0, 0);">类似于C语言宏定义</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(regex)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">re.compile('[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,4}', re.IGNORECASE)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(regex.findall(text))</span></div><div><span style="font-size: 16pt; font-family: 楷体;">['</span><a href="mailto:dave@google.com" style="font-size: 16pt; font-family: 楷体;">dave@google.com</a><span style="font-size: 16pt; font-family: 楷体;">', '</span><a href="mailto:steve@gmail.com" style="font-size: 16pt; font-family: 楷体;">steve@gmail.com</a><span style="font-size: 16pt; font-family: 楷体;">', '</span><a href="mailto:rob@gmail.com" style="font-size: 16pt; font-family: 楷体;">rob@gmail.com</a><span style="font-size: 16pt; font-family: 楷体;">', '</span><a href="mailto:ryan@yahoo.com" style="font-size: 16pt; font-family: 楷体;">ryan@yahoo.com</a><span style="font-size: 16pt; font-family: 楷体;">']</span></div><div><span style="font-size: 16pt; font-family: 楷体;">m = regex.search(text)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(m)</span></div><div><span style="font-size: 16pt; font-family: 楷体;">&lt;_sre.SRE_Match object; span=(5, 20), match='</span><a href="mailto:dave@google.com" style="font-size: 16pt; font-family: 楷体;">dave@google.com</a><span style="font-size: 16pt; font-family: 楷体;">'&gt;</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(text[m.start():m.end()])</span></div><div><a href="mailto:dave@google.com" style="font-size: 16pt; font-family: 楷体;">dave@google.com</a></div><div><span style="font-size: 16pt; font-family: 楷体;">print(regex.match(text))</span></div><div><span style="font-size: 16pt; font-family: 楷体;">None</span></div><div><span style="font-size: 16pt; font-family: 楷体;">print(regex.sub('REDACTED', text))</span></div><div><span style="font-size: 16pt; font-family: 楷体;">Dave REDACTED</span></div><div><span style="font-size: 16pt; font-family: 楷体;">Steve REDACTED</span></div><div><span style="font-size: 16pt; font-family: 楷体;">Rob REDACTED</span></div><div><span style="font-size: 16pt; font-family: 楷体;">Ryan REDACTED</span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div><div><span style="font-size: 16pt; font-family: 楷体;"><br/></span></div></span>
</div></body></html> 